select
	l_returnflag,
	l_linestatus,
	sum(l_quantity) as sum_qty,
	sum(l_extendedprice) as sum_base_price,
	sum(l_extendedprice * (1 - l_discount)) as sum_disc_price,
	sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge,
	avg(l_quantity) as avg_qty,
	avg(l_extendedprice) as avg_price,
	avg(l_discount) as avg_disc,
	count(*) as count_order
from
	lineitem
where
	l_shipdate <= date '1998-12-01' - interval '68 days'
group by
	l_returnflag,
	l_linestatus
order by
	l_returnflag,
	l_linestatus;


Query Stage 0:
ShuffleWriterExec: Some(Hash([Column { name: "l_returnflag", index: 0 }, Column { name: "l_linestatus", index: 1 }], 32))
  AggregateExec: mode=Partial, gby=[l_returnflag@5 as l_returnflag, l_linestatus@6 as l_linestatus], aggr=[SUM(lineitem.l_quantity), SUM(lineitem.l_extendedprice), SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount), SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount * Int64(1) + lineitem.l_tax), AVG(lineitem.l_quantity), AVG(lineitem.l_extendedprice), AVG(lineitem.l_discount), COUNT(*)]
    ProjectionExec: expr=[l_extendedprice@1 * (Some(1),20,0 - l_discount@2) as lineitem.l_extendedprice * (Decimal128(Some(1),20,0) - lineitem.l_discount)Decimal128(Some(1),20,0) - lineitem.l_discountlineitem.l_discountDecimal128(Some(1),20,0)lineitem.l_extendedprice, l_quantity@0 as l_quantity, l_extendedprice@1 as l_extendedprice, l_discount@2 as l_discount, l_tax@3 as l_tax, l_returnflag@4 as l_returnflag, l_linestatus@5 as l_linestatus]
      CoalesceBatchesExec: target_batch_size=8192
        FilterExec: l_shipdate@6 <= 10493
          ParquetExec: file_groups={32 groups: [[mnt/bigdata/tpch/sf100/lineitem.parquet/part1.parquet:0..734840153], [mnt/bigdata/tpch/sf100/lineitem.parquet/part1.parquet:734840153..1469550136, mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:0..130170], [mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:130170..734970323], [mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:734970323..1469810476], [mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:1469810476..1469811062, mnt/bigdata/tpch/sf100/lineitem.parquet/part11.parquet:0..734839567], [mnt/bigdata/tpch/sf100/lineitem.parquet/part11.parquet:734839567..1469679720], [mnt/bigdata/tpch/sf100/lineitem.parquet/part11.parquet:1469679720..1469792487, mnt/bigdata/tpch/sf100/lineitem.parquet/part12.parquet:0..734727386], [mnt/bigdata/tpch/sf100/lineitem.parquet/part12.parquet:734727386..1469567539], [mnt/bigdata/tpch/sf100/lineitem.parquet/part12.parquet:1469567539..1469576762, mnt/bigdata/tpch/sf100/lineitem.parquet/part13.parquet:0..734830930], [mnt/bigdata/tpch/sf100/lineitem.parquet/part13.parquet:734830930..1469671083], [mnt/bigdata/tpch/sf100/lineitem.parquet/part13.parquet:1469671083..1469839488, mnt/bigdata/tpch/sf100/lineitem.parquet/part14.parquet:0..734671748], [mnt/bigdata/tpch/sf100/lineitem.parquet/part14.parquet:734671748..1469511901], [mnt/bigdata/tpch/sf100/lineitem.parquet/part14.parquet:1469511901..1469647240, mnt/bigdata/tpch/sf100/lineitem.parquet/part15.parquet:0..734704814], [mnt/bigdata/tpch/sf100/lineitem.parquet/part15.parquet:734704814..1469544967], [mnt/bigdata/tpch/sf100/lineitem.parquet/part15.parquet:1469544967..1469833433, mnt/bigdata/tpch/sf100/lineitem.parquet/part16.parquet:0..734551687], [mnt/bigdata/tpch/sf100/lineitem.parquet/part16.parquet:734551687..1469391840], [mnt/bigdata/tpch/sf100/lineitem.parquet/part16.parquet:1469391840..1469765133, mnt/bigdata/tpch/sf100/lineitem.parquet/part2.parquet:0..734466860], [mnt/bigdata/tpch/sf100/lineitem.parquet/part2.parquet:734466860..1469212062, mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:0..94951], [mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:94951..734935104], [mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:734935104..1469775257], [mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:1469775257..1469794280, mnt/bigdata/tpch/sf100/lineitem.parquet/part4.parquet:0..734821130], [mnt/bigdata/tpch/sf100/lineitem.parquet/part4.parquet:734821130..1469661283], [mnt/bigdata/tpch/sf100/lineitem.parquet/part4.parquet:1469661283..1469768080, mnt/bigdata/tpch/sf100/lineitem.parquet/part5.parquet:0..734733356], [mnt/bigdata/tpch/sf100/lineitem.parquet/part5.parquet:734733356..1469573509], [mnt/bigdata/tpch/sf100/lineitem.parquet/part5.parquet:1469573509..1469812961, mnt/bigdata/tpch/sf100/lineitem.parquet/part6.parquet:0..734600701], [mnt/bigdata/tpch/sf100/lineitem.parquet/part6.parquet:734600701..1469440854], [mnt/bigdata/tpch/sf100/lineitem.parquet/part6.parquet:1469440854..1469938331, mnt/bigdata/tpch/sf100/lineitem.parquet/part7.parquet:0..734342676], [mnt/bigdata/tpch/sf100/lineitem.parquet/part7.parquet:734342676..1469182829], [mnt/bigdata/tpch/sf100/lineitem.parquet/part7.parquet:1469182829..1469651669, mnt/bigdata/tpch/sf100/lineitem.parquet/part8.parquet:0..734371313], [mnt/bigdata/tpch/sf100/lineitem.parquet/part8.parquet:734371313..1469211466], [mnt/bigdata/tpch/sf100/lineitem.parquet/part8.parquet:1469211466..1469328494, mnt/bigdata/tpch/sf100/lineitem.parquet/part9.parquet:0..734723125], [mnt/bigdata/tpch/sf100/lineitem.parquet/part9.parquet:734723125..1469563265]]}, projection=[l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate], predicate=l_shipdate@10 <= 10493, pruning_predicate=l_shipdate_min@0 <= 10493, required_guarantees=[]

Query Stage 1:
ShuffleWriterExec: None
  SortExec: expr=[l_returnflag@0 ASC NULLS LAST,l_linestatus@1 ASC NULLS LAST]
    ProjectionExec: expr=[l_returnflag@0 as l_returnflag, l_linestatus@1 as l_linestatus, SUM(lineitem.l_quantity)@2 as sum_qty, SUM(lineitem.l_extendedprice)@3 as sum_base_price, SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@4 as sum_disc_price, SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount * Int64(1) + lineitem.l_tax)@5 as sum_charge, AVG(lineitem.l_quantity)@6 as avg_qty, AVG(lineitem.l_extendedprice)@7 as avg_price, AVG(lineitem.l_discount)@8 as avg_disc, COUNT(*)@9 as count_order]
      AggregateExec: mode=FinalPartitioned, gby=[l_returnflag@0 as l_returnflag, l_linestatus@1 as l_linestatus], aggr=[SUM(lineitem.l_quantity), SUM(lineitem.l_extendedprice), SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount), SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount * Int64(1) + lineitem.l_tax), AVG(lineitem.l_quantity), AVG(lineitem.l_extendedprice), AVG(lineitem.l_discount), COUNT(*)]
        CoalesceBatchesExec: target_batch_size=8192
          UnresolvedShuffleExec

Query Stage 2:
ShuffleWriterExec: None
  SortPreservingMergeExec: [l_returnflag@0 ASC NULLS LAST,l_linestatus@1 ASC NULLS LAST]
    UnresolvedShuffleExec

