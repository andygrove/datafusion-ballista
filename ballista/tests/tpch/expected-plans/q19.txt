select
	sum(l_extendedprice* (1 - l_discount)) as revenue
from
	lineitem,
	part
where
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#21'
		and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG')
		and l_quantity >= 8 and l_quantity <= 8 + 10
		and p_size between 1 and 5
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#13'
		and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK')
		and l_quantity >= 20 and l_quantity <= 20 + 10
		and p_size between 1 and 10
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	)
	or
	(
		p_partkey = l_partkey
		and p_brand = 'Brand#52'
		and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG')
		and l_quantity >= 30 and l_quantity <= 30 + 10
		and p_size between 1 and 15
		and l_shipmode in ('AIR', 'AIR REG')
		and l_shipinstruct = 'DELIVER IN PERSON'
	);


Query Stage 0:
ShuffleWriterExec: Some(Hash([Column { name: "p_partkey", index: 0 }], 32))
  CoalesceBatchesExec: target_batch_size=8192
    FilterExec: (p_brand@1 = Brand#21 AND Use p_container@3 IN (SET) ([Literal { value: Utf8("SM CASE") }, Literal { value: Utf8("SM BOX") }, Literal { value: Utf8("SM PACK") }, Literal { value: Utf8("SM PKG") }]) AND p_size@2 <= 5 OR p_brand@1 = Brand#13 AND Use p_container@3 IN (SET) ([Literal { value: Utf8("MED BAG") }, Literal { value: Utf8("MED BOX") }, Literal { value: Utf8("MED PKG") }, Literal { value: Utf8("MED PACK") }]) AND p_size@2 <= 10 OR p_brand@1 = Brand#52 AND Use p_container@3 IN (SET) ([Literal { value: Utf8("LG CASE") }, Literal { value: Utf8("LG BOX") }, Literal { value: Utf8("LG PACK") }, Literal { value: Utf8("LG PKG") }]) AND p_size@2 <= 15) AND p_size@2 >= 1
      ParquetExec: file_groups={32 groups: [[mnt/bigdata/tpch/sf100/part.parquet/part1.parquet:0..20029832], [mnt/bigdata/tpch/sf100/part.parquet/part1.parquet:20029832..40049979, mnt/bigdata/tpch/sf100/part.parquet/part10.parquet:0..9685], [mnt/bigdata/tpch/sf100/part.parquet/part10.parquet:9685..20039517], [mnt/bigdata/tpch/sf100/part.parquet/part10.parquet:20039517..40061159, mnt/bigdata/tpch/sf100/part.parquet/part11.parquet:0..8190], [mnt/bigdata/tpch/sf100/part.parquet/part11.parquet:8190..20038022], [mnt/bigdata/tpch/sf100/part.parquet/part11.parquet:20038022..40056642, mnt/bigdata/tpch/sf100/part.parquet/part12.parquet:0..11212], [mnt/bigdata/tpch/sf100/part.parquet/part12.parquet:11212..20041044], [mnt/bigdata/tpch/sf100/part.parquet/part12.parquet:20041044..40065338, mnt/bigdata/tpch/sf100/part.parquet/part13.parquet:0..5538], [mnt/bigdata/tpch/sf100/part.parquet/part13.parquet:5538..20035370], [mnt/bigdata/tpch/sf100/part.parquet/part13.parquet:20035370..40056587, mnt/bigdata/tpch/sf100/part.parquet/part14.parquet:0..8615], [mnt/bigdata/tpch/sf100/part.parquet/part14.parquet:8615..20038447], [mnt/bigdata/tpch/sf100/part.parquet/part14.parquet:20038447..40068279], [mnt/bigdata/tpch/sf100/part.parquet/part14.parquet:40068279..40070033, mnt/bigdata/tpch/sf100/part.parquet/part15.parquet:0..20028078], [mnt/bigdata/tpch/sf100/part.parquet/part15.parquet:20028078..40057910], [mnt/bigdata/tpch/sf100/part.parquet/part15.parquet:40057910..40064342, mnt/bigdata/tpch/sf100/part.parquet/part16.parquet:0..20023400], [mnt/bigdata/tpch/sf100/part.parquet/part16.parquet:20023400..40053232], [mnt/bigdata/tpch/sf100/part.parquet/part16.parquet:40053232..40065675, mnt/bigdata/tpch/sf100/part.parquet/part2.parquet:0..20017389], [mnt/bigdata/tpch/sf100/part.parquet/part2.parquet:20017389..40047221], [mnt/bigdata/tpch/sf100/part.parquet/part2.parquet:40047221..40061056, mnt/bigdata/tpch/sf100/part.parquet/part3.parquet:0..20015997], [mnt/bigdata/tpch/sf100/part.parquet/part3.parquet:20015997..40045829], [mnt/bigdata/tpch/sf100/part.parquet/part3.parquet:40045829..40059089, mnt/bigdata/tpch/sf100/part.parquet/part4.parquet:0..20016572], [mnt/bigdata/tpch/sf100/part.parquet/part4.parquet:20016572..40046404], [mnt/bigdata/tpch/sf100/part.parquet/part4.parquet:40046404..40058789, mnt/bigdata/tpch/sf100/part.parquet/part5.parquet:0..20017447], [mnt/bigdata/tpch/sf100/part.parquet/part5.parquet:20017447..40047279], [mnt/bigdata/tpch/sf100/part.parquet/part5.parquet:40047279..40055014, mnt/bigdata/tpch/sf100/part.parquet/part6.parquet:0..20022097], [mnt/bigdata/tpch/sf100/part.parquet/part6.parquet:20022097..40051929], [mnt/bigdata/tpch/sf100/part.parquet/part6.parquet:40051929..40060917, mnt/bigdata/tpch/sf100/part.parquet/part7.parquet:0..20020844], [mnt/bigdata/tpch/sf100/part.parquet/part7.parquet:20020844..40050676], [mnt/bigdata/tpch/sf100/part.parquet/part7.parquet:40050676..40051593, mnt/bigdata/tpch/sf100/part.parquet/part8.parquet:0..20028915], [mnt/bigdata/tpch/sf100/part.parquet/part8.parquet:20028915..40055632, mnt/bigdata/tpch/sf100/part.parquet/part9.parquet:0..3115], [mnt/bigdata/tpch/sf100/part.parquet/part9.parquet:3115..20032947], [mnt/bigdata/tpch/sf100/part.parquet/part9.parquet:20032947..40062778]]}, projection=[p_partkey, p_brand, p_size, p_container], predicate=p_size@5 >= 1 AND (p_brand@3 = Brand#21 AND Use p_container@6 IN (SET) ([Literal { value: Utf8("SM CASE") }, Literal { value: Utf8("SM BOX") }, Literal { value: Utf8("SM PACK") }, Literal { value: Utf8("SM PKG") }]) AND p_size@5 <= 5 OR p_brand@3 = Brand#13 AND Use p_container@6 IN (SET) ([Literal { value: Utf8("MED BAG") }, Literal { value: Utf8("MED BOX") }, Literal { value: Utf8("MED PKG") }, Literal { value: Utf8("MED PACK") }]) AND p_size@5 <= 10 OR p_brand@3 = Brand#52 AND Use p_container@6 IN (SET) ([Literal { value: Utf8("LG CASE") }, Literal { value: Utf8("LG BOX") }, Literal { value: Utf8("LG PACK") }, Literal { value: Utf8("LG PKG") }]) AND p_size@5 <= 15), pruning_predicate=p_size_max@0 >= 1 AND (p_brand_min@1 <= Brand#21 AND Brand#21 <= p_brand_max@2 AND (p_container_min@3 <= SM CASE AND SM CASE <= p_container_max@4 OR p_container_min@3 <= SM BOX AND SM BOX <= p_container_max@4 OR p_container_min@3 <= SM PACK AND SM PACK <= p_container_max@4 OR p_container_min@3 <= SM PKG AND SM PKG <= p_container_max@4) AND p_size_min@5 <= 5 OR p_brand_min@1 <= Brand#13 AND Brand#13 <= p_brand_max@2 AND (p_container_min@3 <= MED BAG AND MED BAG <= p_container_max@4 OR p_container_min@3 <= MED BOX AND MED BOX <= p_container_max@4 OR p_container_min@3 <= MED PKG AND MED PKG <= p_container_max@4 OR p_container_min@3 <= MED PACK AND MED PACK <= p_container_max@4) AND p_size_min@5 <= 10 OR p_brand_min@1 <= Brand#52 AND Brand#52 <= p_brand_max@2 AND (p_container_min@3 <= LG CASE AND LG CASE <= p_container_max@4 OR p_container_min@3 <= LG BOX AND LG BOX <= p_container_max@4 OR p_container_min@3 <= LG PACK AND LG PACK <= p_container_max@4 OR p_container_min@3 <= LG PKG AND LG PKG <= p_container_max@4) AND p_size_min@5 <= 15), required_guarantees=[]

Query Stage 1:
ShuffleWriterExec: Some(Hash([Column { name: "l_partkey", index: 0 }], 32))
  ProjectionExec: expr=[l_partkey@0 as l_partkey, l_quantity@1 as l_quantity, l_extendedprice@2 as l_extendedprice, l_discount@3 as l_discount]
    CoalesceBatchesExec: target_batch_size=8192
      FilterExec: (l_quantity@1 >= Some(800),11,2 AND l_quantity@1 <= Some(1800),11,2 OR l_quantity@1 >= Some(2000),11,2 AND l_quantity@1 <= Some(3000),11,2 OR l_quantity@1 >= Some(3000),11,2 AND l_quantity@1 <= Some(4000),11,2) AND (l_shipmode@5 = AIR OR l_shipmode@5 = AIR REG) AND l_shipinstruct@4 = DELIVER IN PERSON
        ParquetExec: file_groups={32 groups: [[mnt/bigdata/tpch/sf100/lineitem.parquet/part1.parquet:0..734840153], [mnt/bigdata/tpch/sf100/lineitem.parquet/part1.parquet:734840153..1469550136, mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:0..130170], [mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:130170..734970323], [mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:734970323..1469810476], [mnt/bigdata/tpch/sf100/lineitem.parquet/part10.parquet:1469810476..1469811062, mnt/bigdata/tpch/sf100/lineitem.parquet/part11.parquet:0..734839567], [mnt/bigdata/tpch/sf100/lineitem.parquet/part11.parquet:734839567..1469679720], [mnt/bigdata/tpch/sf100/lineitem.parquet/part11.parquet:1469679720..1469792487, mnt/bigdata/tpch/sf100/lineitem.parquet/part12.parquet:0..734727386], [mnt/bigdata/tpch/sf100/lineitem.parquet/part12.parquet:734727386..1469567539], [mnt/bigdata/tpch/sf100/lineitem.parquet/part12.parquet:1469567539..1469576762, mnt/bigdata/tpch/sf100/lineitem.parquet/part13.parquet:0..734830930], [mnt/bigdata/tpch/sf100/lineitem.parquet/part13.parquet:734830930..1469671083], [mnt/bigdata/tpch/sf100/lineitem.parquet/part13.parquet:1469671083..1469839488, mnt/bigdata/tpch/sf100/lineitem.parquet/part14.parquet:0..734671748], [mnt/bigdata/tpch/sf100/lineitem.parquet/part14.parquet:734671748..1469511901], [mnt/bigdata/tpch/sf100/lineitem.parquet/part14.parquet:1469511901..1469647240, mnt/bigdata/tpch/sf100/lineitem.parquet/part15.parquet:0..734704814], [mnt/bigdata/tpch/sf100/lineitem.parquet/part15.parquet:734704814..1469544967], [mnt/bigdata/tpch/sf100/lineitem.parquet/part15.parquet:1469544967..1469833433, mnt/bigdata/tpch/sf100/lineitem.parquet/part16.parquet:0..734551687], [mnt/bigdata/tpch/sf100/lineitem.parquet/part16.parquet:734551687..1469391840], [mnt/bigdata/tpch/sf100/lineitem.parquet/part16.parquet:1469391840..1469765133, mnt/bigdata/tpch/sf100/lineitem.parquet/part2.parquet:0..734466860], [mnt/bigdata/tpch/sf100/lineitem.parquet/part2.parquet:734466860..1469212062, mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:0..94951], [mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:94951..734935104], [mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:734935104..1469775257], [mnt/bigdata/tpch/sf100/lineitem.parquet/part3.parquet:1469775257..1469794280, mnt/bigdata/tpch/sf100/lineitem.parquet/part4.parquet:0..734821130], [mnt/bigdata/tpch/sf100/lineitem.parquet/part4.parquet:734821130..1469661283], [mnt/bigdata/tpch/sf100/lineitem.parquet/part4.parquet:1469661283..1469768080, mnt/bigdata/tpch/sf100/lineitem.parquet/part5.parquet:0..734733356], [mnt/bigdata/tpch/sf100/lineitem.parquet/part5.parquet:734733356..1469573509], [mnt/bigdata/tpch/sf100/lineitem.parquet/part5.parquet:1469573509..1469812961, mnt/bigdata/tpch/sf100/lineitem.parquet/part6.parquet:0..734600701], [mnt/bigdata/tpch/sf100/lineitem.parquet/part6.parquet:734600701..1469440854], [mnt/bigdata/tpch/sf100/lineitem.parquet/part6.parquet:1469440854..1469938331, mnt/bigdata/tpch/sf100/lineitem.parquet/part7.parquet:0..734342676], [mnt/bigdata/tpch/sf100/lineitem.parquet/part7.parquet:734342676..1469182829], [mnt/bigdata/tpch/sf100/lineitem.parquet/part7.parquet:1469182829..1469651669, mnt/bigdata/tpch/sf100/lineitem.parquet/part8.parquet:0..734371313], [mnt/bigdata/tpch/sf100/lineitem.parquet/part8.parquet:734371313..1469211466], [mnt/bigdata/tpch/sf100/lineitem.parquet/part8.parquet:1469211466..1469328494, mnt/bigdata/tpch/sf100/lineitem.parquet/part9.parquet:0..734723125], [mnt/bigdata/tpch/sf100/lineitem.parquet/part9.parquet:734723125..1469563265]]}, projection=[l_partkey, l_quantity, l_extendedprice, l_discount, l_shipinstruct, l_shipmode], predicate=(l_shipmode@14 = AIR OR l_shipmode@14 = AIR REG) AND l_shipinstruct@13 = DELIVER IN PERSON AND (l_quantity@4 >= Some(800),11,2 AND l_quantity@4 <= Some(1800),11,2 OR l_quantity@4 >= Some(2000),11,2 AND l_quantity@4 <= Some(3000),11,2 OR l_quantity@4 >= Some(3000),11,2 AND l_quantity@4 <= Some(4000),11,2), pruning_predicate=(l_shipmode_min@0 <= AIR AND AIR <= l_shipmode_max@1 OR l_shipmode_min@0 <= AIR REG AND AIR REG <= l_shipmode_max@1) AND l_shipinstruct_min@2 <= DELIVER IN PERSON AND DELIVER IN PERSON <= l_shipinstruct_max@3 AND (l_quantity_max@4 >= Some(800),11,2 AND l_quantity_min@5 <= Some(1800),11,2 OR l_quantity_max@4 >= Some(2000),11,2 AND l_quantity_min@5 <= Some(3000),11,2 OR l_quantity_max@4 >= Some(3000),11,2 AND l_quantity_min@5 <= Some(4000),11,2), required_guarantees=[l_shipmode in (AIR, AIR REG), l_shipinstruct in (DELIVER IN PERSON)]

Query Stage 2:
ShuffleWriterExec: None
  AggregateExec: mode=Partial, gby=[], aggr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]
    ProjectionExec: expr=[l_extendedprice@6 as l_extendedprice, l_discount@7 as l_discount]
      CoalesceBatchesExec: target_batch_size=8192
        HashJoinExec: mode=Partitioned, join_type=Inner, on=[(p_partkey@0, l_partkey@0)], filter=p_brand@1 = Brand#21 AND Use p_container@3 IN (SET) ([Literal { value: Utf8("SM CASE") }, Literal { value: Utf8("SM BOX") }, Literal { value: Utf8("SM PACK") }, Literal { value: Utf8("SM PKG") }]) AND l_quantity@0 >= Some(800),11,2 AND l_quantity@0 <= Some(1800),11,2 AND p_size@2 <= 5 OR p_brand@1 = Brand#13 AND Use p_container@3 IN (SET) ([Literal { value: Utf8("MED BAG") }, Literal { value: Utf8("MED BOX") }, Literal { value: Utf8("MED PKG") }, Literal { value: Utf8("MED PACK") }]) AND l_quantity@0 >= Some(2000),11,2 AND l_quantity@0 <= Some(3000),11,2 AND p_size@2 <= 10 OR p_brand@1 = Brand#52 AND Use p_container@3 IN (SET) ([Literal { value: Utf8("LG CASE") }, Literal { value: Utf8("LG BOX") }, Literal { value: Utf8("LG PACK") }, Literal { value: Utf8("LG PKG") }]) AND l_quantity@0 >= Some(3000),11,2 AND l_quantity@0 <= Some(4000),11,2 AND p_size@2 <= 15
          CoalesceBatchesExec: target_batch_size=8192
            UnresolvedShuffleExec
          CoalesceBatchesExec: target_batch_size=8192
            UnresolvedShuffleExec

Query Stage 3:
ShuffleWriterExec: None
  ProjectionExec: expr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)@0 as revenue]
    AggregateExec: mode=Final, gby=[], aggr=[SUM(lineitem.l_extendedprice * Int64(1) - lineitem.l_discount)]
      CoalescePartitionsExec
        UnresolvedShuffleExec

